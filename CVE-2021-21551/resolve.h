#pragma once
#include <Windows.h>
#include <Psapi.h>

namespace resolve
{
	/// <summary>
	/// Converts the usermode address received from LoadLibrary
	/// to a kernel address. 
	/// </summary>
	/// <param name="hModule"></param>
	/// <param name="BaseAddress"></param>
	/// <param name="Usermode"></param>
	/// <returns>UINT64</returns>
	UINT64 convert(
		_In_ HMODULE hModule,
		_In_ UINT64 BaseAddress,
		_In_ UINT64 Usermode
	);

	/// <summary>
	/// Resolves the base address of a driver. 
	/// </summary>
	/// <param name="szDriverName"></param>
	/// <param name="BaseAddress"></param>
	/// <returns>true/false</returns>
	bool BaseAddress(
		_In_ const wchar_t* szDriverName,
		_Out_ PUINT64 BaseAddress
	);

	/// <summary>
	/// Resolve nt!MmPteBase to calculate the PTE address of 
	/// a given virtual address. 
	/// </summary>
	/// <param name="BaseAddress"></param>
	/// <param name="Result"></param>
	/// <returns>true/false</returns>
	bool MmPteBase(
		_In_ UINT64 BaseAddress, 
		_Out_ PUINT64 Result
	);
}


/// EOF 